{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\home\\controller\\backextra.js"
    ],
    "names": [
        "mgr",
        "mgm",
        "errorCode",
        "indexAction",
        "data",
        "name",
        "success",
        "adddiscpriceAction",
        "console",
        "log",
        "isGet",
        "userId",
        "cookie",
        "getTestItemList",
        "then",
        "result",
        "error",
        "pm",
        "assign",
        "itemList",
        "display",
        "addinfor",
        "post",
        "senderId",
        "getDiscPriceList",
        "dp",
        "promotionCode",
        "itemid",
        "discList",
        "i",
        "itemId",
        "addDiscPrice",
        "startDate",
        "endDate",
        "price",
        "redirect",
        "updatediscinforAction",
        "discinfor",
        "updDiscPrice",
        "id",
        "adduserAction",
        "infor",
        "addUser",
        "password",
        "phone",
        "email",
        "realName",
        "userRole",
        "deletediscAction",
        "get",
        "deleleDiscPrice",
        "alipayreturnAction",
        "aliinfor",
        "aliinfor1",
        "aliVerify",
        "alipaynotifyAction",
        "infor1",
        "aliNotify",
        "out_trade_no",
        "additemAction",
        "pdtinfor",
        "addItem",
        "deleteitemAction",
        "itemIdinfor",
        "deleteTestItem"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\home\\controller\\backextra.js",
    "sourcesContent": [
        "//都放在一个back.js里面不方便多一个试一下。\r\n\"user strict\"\r\nimport Base from './base.js';\r\nimport UserMgr from '../connect/usermgr.js';\r\nimport BizMgr from '../connect/bizmgr.js';\r\n\r\nvar mgr = new UserMgr();\r\n//-------------------------------\r\nvar mgm = new BizMgr();\r\nvar errorCode = 0;\r\n\r\nexport default class extends Base {\r\n\r\n\t async indexAction(){\r\n\r\n\t \t let data = {name: \"thinkjs\"};\r\n   \t\t this.success(data);\r\n\t }\r\n\r\n\r\n\t async adddiscpriceAction(){\r\n\t \tconsole.log(\"=======adddiscpriceAction start ===================\");\r\n\r\n\t \t if(this.isGet()){\r\n\r\n\t \t \ttry{\r\n\t \t \t\tvar userId = this.cookie('userId');\r\n\t \t \t\tlet pm  = await mgm.getTestItemList(userId)\r\n   \t\t\t\t .then( function (result) { \r\n      \r\n      \t\t\t return result;\r\n   \t\t\t\t\t\t\t\t },   \r\n   \t\t\t\t\t function (error) {   \r\n       \t\t\t\tconsole.log(error);   \r\n   \t\t\t\t\t\t });\r\n     \r\n   \t\t\t\t console.log(\"======pricelistAction pm=========\");\r\n    \t\t\tconsole.log(pm);\r\n\r\n    \t\t\tthis.assign('itemList',pm.itemList);\r\n\t \t \t}catch(e){\r\n\r\n\t \t \t}\r\n      return this.display();\r\n    }\r\n\t \t\r\n\t \t\r\n\t \t\r\n\r\n\r\n\t \t//get itemname to html\r\n\r\n\t \ttry{\r\n\t \t\tvar addinfor = this.post();\r\n\t \t\tconsole.log(addinfor);\r\n\t \t\tvar senderId = this.cookie('userId');\r\n\r\n\t \t\t//judge promotioncode exit is or not \r\n\t \t\t let dp  = await mgm.getDiscPriceList(senderId)\r\n    .then( function (result) { \r\n      //process.stdout.write(result);\r\n      //console.log(result.toString()); \r\n      //var ret = JSON.parse(result.toString());\r\n     // pm.pname = BizMgr.getPrductName(pm.productid)\r\n      return result;\r\n    },   \r\n    function (error) {   \r\n       console.log(error);   \r\n    });\r\n    \t\tconsole.log(\"=========dp==============\");\r\n    \t\tconsole.log(dp);\r\n    \t\tconsole.log(addinfor.promotionCode+addinfor.itemid);\r\n    \t\tconsole.log(dp.discList);\r\n    \t\tfor(let i in dp.discList){\r\n    \t\t\tconsole.log(dp.discList[i].promotionCode+\"||\"+dp.discList[i].itemId);\r\n    \t\t\tif(dp.discList[i].promotionCode==addinfor.promotionCode&&dp.discList[i].itemId==addinfor.itemid){\r\n    \t\t\t\tconsole.log(\"pay success\");\r\n    \t\t\t\tconsole.log(dp.discList[i].itemId);\r\n    \t\t\t\t//this.error(\"addtip\",\"优惠码已存在\");\r\n    \t\t\t\t//this.assign(\"addtip\",\"优惠码已存在\");\r\n    \t\t\t\t//return this.redirect(\"/backextra/adddiscprice\");\r\n    \t\t\t\treturn this.error(\"addtip\",\"优惠码已存在\");\r\n\r\n    \t\t\t\t\r\n    \t\t\t}else{\r\n    \t\t\t\tlet pm = await mgm.addDiscPrice(senderId, addinfor.promotionCode, addinfor.itemid, addinfor.startDate, addinfor.endDate, addinfor.price)\r\n\t \t\t.then(function(result){\r\n\r\n\t \t\t\treturn result;\r\n\t \t\t},function(error){\r\n\t \t\t\treturn error;\r\n\t \t\t})\r\n\r\n\t \t\treturn this.redirect(\"/back/disclist\");\r\n    \t\t\t}\r\n\r\n    \t\t}\r\n\r\n\t \t\t\r\n    \t/*\t*/\r\n\t \t}catch(e){\r\n\r\n\t \t}\r\n\r\n\t \treturn this.display();\r\n\t \t//return this.redirect(\"/back/disclist\");\r\n\t }\r\n\r\n\t async updatediscinforAction(){\r\n\t \tvar discinfor = this.post();\r\n\t \tconsole.log(\"======discinforAction start=============\");\r\n\t \tconsole.log(discinfor);\r\n\t \tvar senderId = this.cookie('userId');\r\n\t \ttry{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t \t\tlet pm = await mgm.updDiscPrice(senderId,discinfor.id,discinfor.promotionCode,discinfor.itemId, discinfor.startDate, discinfor.endDate, discinfor.price)\r\n\t \t\t.then(function(result){\r\n\r\n\t \t\t\t\treturn result;\r\n\t \t\t})\r\n\t \t\t\r\n\t \t}catch(e){\r\n\t \t\treturn this.redirect(\"/index/index\");\r\n\t \t}\r\n\r\n\t \treturn this.redirect(\"/back/disclist\");\r\n\r\n\r\n\t }\r\n\r\n\t async adduserAction(){\r\n\r\n\t \tvar infor = this.post();\r\n\r\n\t \tconsole.log(\"======adduserAction start============\");\r\n\r\n\t \tconsole.log(infor);\r\n\r\n\t \ttry{\r\n\t \t\tvar senderId = this.cookie('userId');\r\n       \t   // var userId = this.get('userId');\r\n\r\n\t \t\tlet pm = await mgr.addUser(senderId,infor.name,infor.password,infor.phone,infor.email,infor.realName,infor.userRole)\r\n\r\n\t \t\t.then(function(result){\r\n\r\n\t \t\t\treturn result;\r\n\t \t\t},function(error){\r\n\t \t\t\treturn error;\r\n\t \t\t})\r\n\t \t}catch(e){\r\n\t \t\treturn this.display(\"index/index\");\r\n\t \t}\r\n\r\n\r\n\t \treturn this.redirect(\"/back/userlist\");\r\n\t }\r\n\r\n\r\n\t async deletediscAction(){\r\n\t \tvar infor = this.get();\r\n\t \tconsole.log(\"=======deletediscAction start ==============\");\r\n\r\n\t \tconsole.log(infor);\r\n\r\n\t \ttry{\r\n\t \t\tvar senderId = this.cookie('userId');\r\n\r\n\t \t\tlet pm = await mgm.deleleDiscPrice(senderId,infor.id)\r\n\t \t\t.then(function(result){\r\n\t \t\t\treturn result;\r\n\r\n\t \t\t})\r\n\t \t}catch(e){\r\n\t \t\treturn this.redirect(\"/index/index\");\r\n\t \t}\r\n\r\n\t \treturn this.redirect(\"/back/disclist\");\r\n\t }\r\n\r\n\r\n\t async alipayreturnAction(){\r\n\r\n\r\n\t \tconsole.log(\"alipayreturnAction start\");\r\n\t \tvar aliinfor = this.get();\r\n\t \t//var senderId = this.cookie('userId');\r\n\t \tconsole.log(aliinfor);\r\n\t \tlet senderId = this.cookie('userId');\r\n\r\n\t \tconsole.log(senderId);\r\n\t \ttry{\r\n\t \t\t//\r\n\t \t\tconsole.log(\"==========senderId========\");\r\n\t \t\tconsole.log(senderId);\r\n\t \t\tvar aliinfor1 = JSON.stringify(aliinfor); \r\n\t \t\tlet pm = await mgm.aliVerify(senderId, \"UTF-8\", aliinfor1)\r\n\t \t\t.then(function(result){\r\n\r\n\t \t\t\treturn result;\r\n\t \t\t},function(error){\r\n\t \t\t\treturn error;\r\n\t \t\t})\r\n\r\n\r\n\t \t\tconsole.log(pm);\r\n\t \t}catch(e){\r\n\r\n\r\n\t \t}\r\n\t \treturn this.redirect(\"/report/query\");\r\n\r\n\r\n\r\n\t }\r\n\r\n\t async  alipaynotifyAction(){\r\n\r\n\t \tconsole.log(\"==========alipaynotifyAction start=========\");\r\n\t \tvar infor = this.post();\r\n\t \tconsole.log(infor);\r\n\t \tvar infor1 = JSON.stringify(infor);\r\n\r\n\t \tlet pm = await  mgm.aliNotify(infor.out_trade_no, 'UTF-8', infor1)\r\n\t \t.then(function(result){\r\n\r\n\t \t\treturn result;\r\n\t \t})\r\n\t \t\r\n\t \tconsole.log(pm);\r\n\t \t\r\n\t \t\r\n\t \treturn  this.success(infor);\r\n\r\n\r\n\t }\r\n\r\n\r\n\t async additemAction(){\r\n\t \t\tconsole.log(\"==========alipaynotifyAction start=========\");\r\n\t \t\tif(this.isGet()){\r\n\r\n\t \t\t\treturn this.display();\r\n\t \t\t}\r\n\r\n\t \t\tvar pdtinfor =this.post();\r\n\r\n\t \t\tconsole.log(pdtinfor);\r\n\t \t\tlet senderId = this.cookie('userId');\r\n\t \t\ttry{\r\n\t \t\t\tlet pm = await mgm.addItem(senderId,pdtinfor)\r\n\t \t\t\t.then(function(result){\r\n\r\n\t \t\t\t\treturn result;\r\n\t \t\t\t})\r\n\t \t\t}catch(e){\r\n\r\n\t \t\t}\r\n\r\n\r\n\r\n\t \t\treturn this.redirect('/back/pricelist');\r\n\t }\r\n\r\n\r\n\t async deleteitemAction(){\r\n\r\n\t \tconsole.log(\"=========deleteAction start============\");\r\n\r\n\t \t\tlet itemIdinfor = this.get();\r\n\t \t\tlet senderId = this.cookie('userId');\r\n\t \ttry{\r\n\t \t\tlet pm = await mgm.deleteTestItem(senderId,itemIdinfor.itemId)\r\n\t \t\t.then(function(result){\r\n\r\n\t \t\t\treturn result;\r\n\t \t\t})\r\n\r\n\t \t\tconsole.log(pm);\r\n\t \t\t\r\n\t \t}catch(e){\r\n\r\n\r\n\t \t}\r\n\r\n\t \treturn this.redirect(\"/back/pricelist\");\r\n\t }\r\n}"
    ]
}